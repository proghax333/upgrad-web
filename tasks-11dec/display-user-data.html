<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
  <main class="flex flex-col">
    <div class="w-full max-w-lg mx-auto">
      <button id="randomizer" class="mt-4 ml-auto bg-blue-500 text-white p-2 flex gap-2 rounded-md">&#x1F500;
        Random</button>
    </div>
    <div class="mt-4 min-h-52 w-full max-w-lg mx-auto border py-4 px-4 md:px-8">
      <div id="details" class="hidden">
        <h2 class="text-center text-2xl" id="name">Leanne Graham</h2>
        <p class="text-center text-gray-600 font-thin" id="username">@Bret</p>

        <div class="mt-4 grid items-center gap-2" style="grid-template-columns: auto 1fr;">
          <p class="font-semibold">&#x2709;</p>
          <p class="text-sm" id="email">Sincere@april.biz</p>
          <p class="font-semibold">&#x1F4DE;</p>
          <p class="text-sm" id="phone">1-770-736-8031 x56442</p>
          <p class="font-semibold">&#x1F310;</p>
          <p class="text-sm" id="website">hildegard.org</p>
        </div>
      </div>
    </div>
    <div class="w-full max-w-lg mx-auto h-52 overflow-y-auto border">
      <ul id="usersList">
      </ul>
    </div>
  </main>

  <script>
    const select = q => document.querySelector(q);
    const details = select("#details");
    const usersList = select("#usersList");
    const randomizer = select("#randomizer");

    let users = null;

    randomizer.addEventListener("click", (e) => {
      handleRandomSelect();
    });

    async function main() {
      users = await getUsers();

      renderUsersList();
      handleRandomSelect();
    }

    function handleRandomSelect() {
      if (!users) {
        return;
      }

      const randomIndex = Math.floor(Math.random() * users.length);
      const randomUser = users[randomIndex];
      handleLoadUser(randomUser.id);
    }

    async function renderUsersList() {
      usersList.innerHTML = "";

      for (const user of users) {
        const li = document.createElement("li");
        li.classList = "p-2 px-4 border-b cursor-pointer"
        li.innerText = user.name;
        li.addEventListener("click", (e) => {
          handleLoadUser(user.id);
        });

        usersList.appendChild(li);
      }
    }

    main();

    async function getUsers() {
      const response = await fetch("https://jsonplaceholder.typicode.com/users");
      return response.json();
    }

    async function getUser(id) {
      const response = await fetch(`https://jsonplaceholder.typicode.com/users/${id}`);
      return response.json();
    }

    async function handleLoadUser(id) {
      const user = await getUser(id);
      renderUser(user);
    }

    async function renderUser(user) {
      const name = select("#name");
      const username = select("#username");
      const email = select("#email");
      const phone = select("#phone");
      const website = select("#website");

      const elements = {
        name, username, email, phone, website
      };

      for (const e in elements) {
        elements[e].innerText = user[e];
      }

      details.classList.remove("hidden");
    }
  </script>

</body>

</html>