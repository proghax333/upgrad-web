<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Orders List</title>

  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen">
  <main class="flex flex-col">
    <div class="max-w-lg mx-auto w-full my-10 p-6 bg-white shadow-md rounded-md border">
      <h2 class="text-2xl font-bold mb-6">Orders</h2>
      <div class="mb-6">
        <h3 class="font-semibold mb-2">Filter by Status</h3>

        <div id="filterGroup" class="flex gap-6 flex-wrap">
        </div>
      </div>

      <div id="ordersContainer" class="flex flex-col gap-4"></div>

      <div class="flex justify-between items-center mt-6">
        <button id="prevBtn" class="px-4 py-2 bg-gray-300 rounded-md disabled:opacity-40">Previous</button>
        <span id="pageIndicator" class="font-semibold"></span>
        <button id="nextBtn" class="px-4 py-2 bg-gray-300 rounded-md disabled:opacity-40">Next</button>
      </div>
    </div>
  </main>


  <script>
    const API_BASE_URL = "https://upgrad-demo.onrender.com";

    async function getOrders() {
      // Thank you, o great CORS, for your divine service.
      // May you protect us all from the eternal damnation of Cross-Site Vulnerabilities.

      // const response = await fetch(`${API_BASE_URL}/api/orders`);
      // const result = await response.json();
      // return result.data;


      return {
        "success": true,
        "count": 26,
        "data": [
          {
            "id": 1,
            "customer": "Rajesh Kumar",
            "email": "rajesh@example.com",
            "product": "Laptop",
            "quantity": 1,
            "price": 1200,
            "total": 1200,
            "status": "Delivered",
            "date": "2025-12-01"
          },
          {
            "id": 2,
            "customer": "Priya Sharma",
            "email": "priya@example.com",
            "product": "Mouse",
            "quantity": 2,
            "price": 25,
            "total": 50,
            "status": "Processing",
            "date": "2025-12-05"
          },
          {
            "id": 3,
            "customer": "Amit Patel",
            "email": "amit@example.com",
            "product": "Keyboard",
            "quantity": 1,
            "price": 80,
            "total": 80,
            "status": "Shipped",
            "date": "2025-12-03"
          },
          {
            "id": 4,
            "customer": "Neha Gupta",
            "email": "neha@example.com",
            "product": "Monitor",
            "quantity": 1,
            "price": 350,
            "total": 350,
            "status": "Delivered",
            "date": "2025-11-28"
          },
          {
            "id": 5,
            "customer": "Arjun Singh",
            "email": "arjun@example.com",
            "product": "USB Hub",
            "quantity": 3,
            "price": 15,
            "total": 45,
            "status": "Pending",
            "date": "2025-12-08"
          },
          {
            "id": 6,
            "customer": "Anjali Verma",
            "email": "anjali@example.com",
            "product": "Webcam",
            "quantity": 1,
            "price": 65,
            "total": 65,
            "status": "Delivered",
            "date": "2025-11-30"
          },
          {
            "id": 7,
            "customer": "Vikram Reddy",
            "email": "vikram@example.com",
            "product": "Headphones",
            "quantity": 1,
            "price": 120,
            "total": 120,
            "status": "Delivered",
            "date": "2025-12-02"
          },
          {
            "id": 8,
            "customer": "Sneha Iyer",
            "email": "sneha@example.com",
            "product": "SSD 1TB",
            "quantity": 1,
            "price": 140,
            "total": 140,
            "status": "Shipped",
            "date": "2025-12-06"
          },
          {
            "id": 9,
            "customer": "Rohan Desai",
            "email": "rohan@example.com",
            "product": "RAM 16GB",
            "quantity": 2,
            "price": 90,
            "total": 180,
            "status": "Processing",
            "date": "2025-12-07"
          },
          {
            "id": 10,
            "customer": "Pooja Nair",
            "email": "pooja@example.com",
            "product": "Power Bank",
            "quantity": 1,
            "price": 45,
            "total": 45,
            "status": "Delivered",
            "date": "2025-11-25"
          },
          {
            "id": 11,
            "customer": "Karthik Menon",
            "email": "karthik@example.com",
            "product": "Laptop Stand",
            "quantity": 1,
            "price": 35,
            "total": 35,
            "status": "Pending",
            "date": "2025-12-08"
          },
          {
            "id": 12,
            "customer": "Divya Agarwal",
            "email": "divya@example.com",
            "product": "External HDD 2TB",
            "quantity": 1,
            "price": 85,
            "total": 85,
            "status": "Shipped",
            "date": "2025-12-04"
          },
          {
            "id": 13,
            "customer": "Sanjay Kumar",
            "email": "sanjay@example.com",
            "product": "Graphics Card",
            "quantity": 1,
            "price": 450,
            "total": 450,
            "status": "Processing",
            "date": "2025-12-06"
          },
          {
            "id": 14,
            "customer": "Ritika Singh",
            "email": "ritika@example.com",
            "product": "Mechanical Keyboard",
            "quantity": 1,
            "price": 110,
            "total": 110,
            "status": "Delivered",
            "date": "2025-12-01"
          },
          {
            "id": 15,
            "customer": "Nikhil Patel",
            "email": "nikhil@example.com",
            "product": "Wireless Mouse",
            "quantity": 2,
            "price": 35,
            "total": 70,
            "status": "Shipped",
            "date": "2025-12-05"
          },
          {
            "id": 16,
            "customer": "Swathi Reddy",
            "email": "swathi@example.com",
            "product": "USB-C Cable",
            "quantity": 5,
            "price": 12,
            "total": 60,
            "status": "Delivered",
            "date": "2025-11-29"
          },
          {
            "id": 17,
            "customer": "Arun Nair",
            "email": "arun@example.com",
            "product": "Monitor Stand",
            "quantity": 1,
            "price": 55,
            "total": 55,
            "status": "Pending",
            "date": "2025-12-08"
          },
          {
            "id": 18,
            "customer": "Meera Kapoor",
            "email": "meera@example.com",
            "product": "Cooling Pad",
            "quantity": 1,
            "price": 40,
            "total": 40,
            "status": "Processing",
            "date": "2025-12-07"
          },
          {
            "id": 19,
            "customer": "Abhishek Singh",
            "email": "abhishek@example.com",
            "product": "Desk Lamp",
            "quantity": 1,
            "price": 50,
            "total": 50,
            "status": "Delivered",
            "date": "2025-12-02"
          },
          {
            "id": 20,
            "customer": "Isha Verma",
            "email": "isha@example.com",
            "product": "HDMI Cable",
            "quantity": 3,
            "price": 8,
            "total": 24,
            "status": "Shipped",
            "date": "2025-12-06"
          },
          {
            "id": 21,
            "customer": "Rajiv Gupta",
            "email": "rajiv@example.com",
            "product": "Wireless Charger",
            "quantity": 1,
            "price": 55,
            "total": 55,
            "status": "Delivered",
            "date": "2025-11-27"
          },
          {
            "id": 22,
            "customer": "Anjana Pillai",
            "email": "anjana@example.com",
            "product": "Phone Stand",
            "quantity": 2,
            "price": 18,
            "total": 36,
            "status": "Pending",
            "date": "2025-12-08"
          },
          {
            "id": 23,
            "customer": "Saurav Yadav",
            "email": "saurav@example.com",
            "product": "Screen Protector",
            "quantity": 10,
            "price": 5,
            "total": 50,
            "status": "Processing",
            "date": "2025-12-07"
          },
          {
            "id": 24,
            "customer": "Chandrika Nath",
            "email": "chandrika@example.com",
            "product": "Cable Organizer",
            "quantity": 1,
            "price": 22,
            "total": 22,
            "status": "Delivered",
            "date": "2025-12-03"
          },
          {
            "id": 25,
            "customer": "Varun Malhotra",
            "email": "varun@example.com",
            "product": "Surge Protector",
            "quantity": 1,
            "price": 35,
            "total": 35,
            "status": "Shipped",
            "date": "2025-12-05"
          },
          {
            "id": 26,
            "customer": "Priyanka Das",
            "email": "priyanka@example.com",
            "product": "Laptop Bag",
            "quantity": 1,
            "price": 75,
            "total": 75,
            "status": "Delivered",
            "date": "2025-11-26"
          }
        ]
      }
    }


    const ordersData = JSON.parse(`YOUR_JSON_HERE`.replace(/YOUR_JSON_HERE/, JSON.stringify({
      success: true,
      count: 26,
      data: []
    })));

    let orders = ordersData.data;

    const ordersContainer = document.querySelector("#ordersContainer");
    const prevBtn = document.querySelector("#prevBtn");
    const nextBtn = document.querySelector("#nextBtn");
    const pageIndicator = document.querySelector("#pageIndicator");
    const filterGroup = document.querySelector("#filterGroup");

    let paginator = null;
    let filteredOrders = [...orders];

    const statuses = ["Pending", "Processing", "Shipped", "Delivered"];

    function paginate(data, { limit }) {
      const totalItems = data.length;
      let currentPage = 1;

      const totalPages = Math.ceil(totalItems / limit);

      const hasPrevious = () => currentPage > 1;
      const hasNext = () => currentPage < totalPages;

      const next = () => { if (hasNext()) currentPage++; };
      const previous = () => { if (hasPrevious()) currentPage--; };

      const hasPage = (page) => page >= 1 && page <= totalPages;

      const goto = (page) => { if (hasPage(page)) currentPage = page; };

      const getPage = (page) => {
        const start = (page - 1) * limit;
        return data.slice(start, start + limit);
      };

      const getCurrentPage = () => getPage(currentPage);

      return {
        totalPages,
        totalItems,

        hasPrevious,
        hasNext,
        previous,
        next,
        hasPage,
        goto,

        getCurrentPage,
        getPage,

        get currentPage() {
          return currentPage;
        }
      };
    }

    function renderOrders() {
      const orders = paginator.getCurrentPage();

      if (orders.length === 0) {
        ordersContainer.innerHTML = `
          <p class="text-center text-gray-600 py-4">No orders found.</p>
        `;
      } else {
        ordersContainer.innerHTML = orders.map(o => `
          <div class="border p-4 rounded-md shadow-sm bg-white">
            <div class="flex justify-between">
              <h3 class="font-semibold text-lg">${o.product}</h3>
              <span class="text-sm px-2 py-1 rounded bg-gray-200">${o.status}</span>
            </div>

            <p class="text-gray-700 mt-1"><strong>Customer:</strong> ${o.customer}</p>
            <p class="text-gray-700"><strong>Email:</strong> ${o.email}</p>

            <div class="mt-2 flex justify-between">
              <span><strong>Qty:</strong> ${o.quantity}</span>
              <span><strong>Total:</strong> $${o.total}</span>
              <span><strong>Date:</strong> ${o.date}</span>
            </div>
          </div>
        `).join("");
      }

      pageIndicator.textContent = `Page ${paginator.currentPage} / ${paginator.totalPages}`;

      prevBtn.disabled = !paginator.hasPrevious();
      nextBtn.disabled = !paginator.hasNext();
    }

    function renderFilters() {
      filterGroup.innerHTML = statuses
        .map(status => `
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="checkbox" value="${status}" class="status-checkbox w-4 h-4">
            <span>${status}</span>
          </label>
        `)
        .join("");
    }

    function attachFilterEvents() {
      const checkboxes = document.querySelectorAll(".status-checkbox");

      checkboxes.forEach(cb => {
        cb.addEventListener("change", () => {
          if (cb.checked) {
            checkboxes.forEach(other => {
              if (other !== cb) other.checked = false;
            });

            filteredOrders = orders.filter(o => o.status === cb.value);
          } else {
            filteredOrders = [...orders];
          }

          paginator = paginate(filteredOrders, { limit: 5 });
          renderOrders();
        });
      });
    }

    async function init() {
      const ordersData = await getOrders();
      orders = ordersData.data;

      renderFilters();
      attachFilterEvents();

      filteredOrders = [...orders];
      paginator = paginate(filteredOrders, { limit: 5 });

      renderOrders();
    }

    prevBtn.addEventListener("click", () => {
      paginator.previous();
      renderOrders();
    });

    nextBtn.addEventListener("click", () => {
      paginator.next();
      renderOrders();
    });

    init();
  </script>

</body>

</html>